"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const fastify_plugin_1 = __importDefault(require("fastify-plugin"));
const bcrypt_1 = __importDefault(require("bcrypt"));
const bcryptPlugin = (fastify, options, done) => {
    if (fastify.bcrypt)
        return done(new Error("fastify-bcrypt-plugin has been defined before"));
    const hash = (data) => bcrypt_1.default.hash(data, options.saltOrRounds || 10);
    const compare = (data, encrypted) => bcrypt_1.default.compare(data, encrypted);
    fastify
        .decorate("bcrypt", { hash, compare })
        .decorateRequest("bcrypt", { hash, compare });
    done();
};
const fastifyBcrypt = fastify_plugin_1.default(bcryptPlugin, {
    fastify: "3.x",
    name: "fastify-bcrypt,plugin",
});
exports.default = fastifyBcrypt;
//# sourceMappingURL=index.js.map